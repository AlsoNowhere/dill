"use strict";window._dill={modules:{}},function(){var r=function(e,t){var n,i,a=!1;return"!"===e.substr(0,1)&&(e=e.substring(1,e.length),a=!0),n="function"==typeof(i=t[e])?i.apply(t):i,a&&(n=!n),void 0===n?"":n};window._dill.debracer=r,window._dill.bracer=function(e,i){var a=function(e){var t=e.indexOf("{{"),n=e.indexOf("}}");return-1===t?e:-1===n?e:e.substring(0,t)+r(e.substring(t+2,n),i)+a(e.substring(n+2,e.length))};return a(e)}}(),function(){var i=function(e,t,n){this.name=e,this.data=t,this.template=n};window._dill.Component=i,window._dill.generate_component=function(e,t,n){return new i(e,t,n)}}(),window._dill.create_attributes=function(o,l){var s=[];return this.for_each(o.attributes,function(t){var e,n=t.nodeName,i=n.substr(0,1),a=n.substr(n.length-1,1),r=function(){o.removeAttribute(n)};return"[(value)]"===n||":name:"===n?(s.push({name:"value",value:t.nodeValue}),o.value=l[t.nodeValue]?l[t.nodeValue]:"",o.addEventListener("input",function(){l[t.nodeValue]=o.value,dill.change()}.bind(this)),void r()):"["===i&&"]"===a||":"===i?(s.push({name:n.substring(1,n.length-(":"!==i)),value:t.nodeValue}),void r()):void(("("===i&&")"===a||":"===a)&&(e=n.substring(1,n.length-(":"!==a)),o.addEventListener(e,function(e){void 0!==l[t.nodeValue]?!1!==l[t.nodeValue].apply(l,[e,o])&&dill.change():dill.change()}),r()))}.bind(this)),s},function(){var r=function(e,t,n){this.type=e,this.data=t,this.module=n};window._dill.create_template=function(n,e,i){var t,a=new r(n.nodeName,e,i);return"#text"===n.nodeName||"#comment"===n.nodeName?(a.value=n.nodeValue,a):(t=n.hasAttribute("dill-for"),this.dill_template&&this.dill_template(n,e),this.dill_extends&&this.dill_extends(n,e),this.template_if&&this.template_if(n,a),this.template_for&&this.template_for(n,a),t||(this.for_each(n.attributes,function(e){var t=e.nodeName;"#"===t.substr(0,1)&&i.set_element(t.substring(1,t.length),n)}),this.template_component&&this.template_component(n,a,i)?this.component_attributes(n,a):a.attributes=this.create_attributes(n,e),a.childs=Array.prototype.map.apply(n.childNodes,[function(e){return this.create_template(e,a.data,i)}.bind(this)])),a)}}(),window._dill.create_data_object=function(e){var t=e.template_object,n=e.parent_data,i=e.index,a=e.scope,r=function(t){"object"==typeof t&&Object.keys(t).forEach(function(e){this[e]=t[e]}.bind(this)),void 0!==i&&(this._item=t,this._index=i),a&&(this._display=n)};return(a="normal"===a||void 0===a||"isolate"!==a)&&(r.prototype=n),new r(t)},window._dill.dill_extends=function(e,t){var n,i;e.hasAttribute("dill-extends")&&(i=t[(n=e).attributes["dill-extends"].nodeValue],Object.keys(i).forEach(function(e){var t="["===e.substr(0,1)&&"]"===e.substr(e.length-1,1)?":"+e.substring(1,e.length-1):"("===e.substr(0,1)&&")"===e.substr(e.length-1,1)?e.substring(1,e.length-1)+":":e;n.setAttribute(t,i[e])}))},window._dill.template_for=function(e,t){if(e.hasAttribute("dill-for")&&t.data[e.attributes["dill-for"].nodeValue]){var n,i=t.data[e.attributes["dill-for"].nodeValue].length,a=e.attributes["dill-for"].nodeValue;0<i&&(n=this.create_data_object({template_object:t.data[e.attributes["dill-for"].nodeValue][0],parent_data:t.data,index:0}),t.data=n),e.removeAttribute("dill-for"),t.for={clone:e.cloneNode(!0),initial:1,currents:0<i?[this.create_template(e,n,t.module)]:[],value:a}}},window._dill.render_for=function(e,n){var t,i,a,r,o=n.for.initial,l=e,s=n.data[n.for.value];if(n.for.initial<s.length){for(t=1;t<n.for.initial;t++)l=l.nextElementSibling;for(i=s.length,t=n.for.initial;t<i;t++)0<n.for.initial?l.insertAdjacentElement("afterend",n.for.clone.cloneNode(!0)):l.parentNode.insertBefore(n.for.clone.cloneNode(!0),e),l=0<o||t!==n.for.initial?l.nextElementSibling:e.previousElementSibling,a=this.create_data_object({template_object:s[t],parent_data:n.data._display,index:t}),n.data=a,l.removeAttribute("dill-for"),r=this.create_template(l,n.data,n.module),n.for.currents.push(r)}else if(n.for.initial>s.length){for(t=1;t<s.length;t++)l=l.nextElementSibling;for(t=0;t<n.for.initial-s.length;t++)l.parentNode.removeChild(1===n.for.initial?l:l.nextElementSibling),n.for.currents.pop()}return l=0<o?e:e.previousElementSibling,n.for.initial=s.length,function(e){var t;for(t=0;t<s.length;t++)n.for.currents[t].data._item=s[t],n.for.currents[t].data._index=t,"object"==typeof s[t]&&Object.keys(s[t]).forEach(function(e){n.for.currents[t].data[e]=s[t][e]});for(t=0;t<n.for.initial;t++)this.render_element(e,n.for.currents[t]),e=e.nextElementSibling}.apply(this,[l]),n.for.initial},window._dill.template_if=function(e,t){e.hasAttribute("dill-if")&&(t.if={element:e,value:e.attributes["dill-if"].nodeValue,initial:!0,parent:e.parentNode})},window._dill.render_if=function(e,t){var n=this.debracer(t.if.value,t.data);if(!t.if.initial&&n)void 0===e?t.if.parent.appendChild(t.if.element):e.parentNode.insertBefore(t.if.element,e),e=t.if.element,t.if.initial=n;else{if(t.if.initial&&!n)return e.parentNode.removeChild(e),t.if.initial=n,0;if(!t.if.initial&&!n)return 0}return 1},window._dill.for_each=function(e,t){for(var n=e.length-1;0<=n;n--)t(e[n],n)},function(){var i=window._dill,e=function(e,t){this.name=e,this.components={},this.services={},this.elements={},t&&Object.keys(t).forEach(function(e){e.components.forEach(function(e){this.components[e.name]=e}.bind(this)),e.services.forEach(function(e){this.services[e.name]=e}.bind(this)),e.elements.forEach(function(e){this.elements[e.name]=e}.bind(this))}.bind(this))};e.prototype={set_component:function(e,t,n){e instanceof i.Component?this.components[e.name]=e:this.components[e]=i.generate_component(e,t,n)},set_service:function(e,t){var n;e instanceof i.Service?this.services[e.name]=e.data:(n=i.generate_service(e,t),this.services[n.name]=n.data)},set_element:function(e,t){this.elements[e]=t}},window._dill.Module=e;var a,n=(a=window._dill.Module,function(e,t){var n=new a(e,t);return Object.seal(n),Object.freeze(n),n});window._dill.create_module=function(e,t){return n(e,t)}}(),window._dill.render_element=function(i,a){var e;return"#text"===a.type?(i.nodeValue=this.bracer(a.value,a.data),1):"#comment"===a.type?1:a.hasOwnProperty("if")&&0===(e=this.render_if(i,a))?e:a.hasOwnProperty("for")?this.render_for(i,a):(a.attributes&&a.attributes.forEach(function(e){var t=this.debracer(e.value,a.data);i.setAttribute(e.name,t),"value"===e.name&&setTimeout(function(){void 0!==t&&(i.value=t)},0),t||i.removeAttribute(e.name)}.bind(this)),function(){var n=0;a.childs.forEach(function(e,t){n+=this.render_element(i.childNodes[n],e)}.bind(this))}.apply(this),1)},function(){var n=function(e,t){this.name=e,this.data="function"==typeof t?new t:"object"!=typeof t||Array.isArray(t)?null:t};window._dill.Service=n,window._dill.generate_service=function(e,t){return new n(e,t)}}(),window._dill.template_component=function(e,t,n){var i=n.components[e.nodeName.toLowerCase()];return!!i&&(e.innerHTML=i.template,"object"==typeof i.data?t.data=this.create_data_object({template_object:i.data,parent_data:t.data,scope:e.hasAttribute("dill-scope")?e.attributes["dill-scope"].nodeValue:void 0}):"function"==typeof i.data&&(t.data=new i.data),t.data.hasOwnProperty("oninit")&&t.data.oninit(),!0)},window._dill.component_attributes=function(e,o){this.for_each(e.attributes,function(e){var t,n,i=e.nodeName,a=i.substr(0,1),r=i.substr(i.length-1,1);("["===a&&"]"===r||":"===a)&&(n=(t=e.nodeValue).length,t="'"===t.substr(0,1)&&"'"===t.substr(n-1,n)?"true"===t.substring(1,n-1)||"false"!==t.substring(1,n-1)&&t.substring(1,n-1):o.data._display[t],i=i.substring(1,i.length-(":"!==a)),o.data[i]=t)})},window._dill.dill_template=function(e,t){var n,i;e.hasAttribute("dill-template")&&(n=e.innerHTML,!1!==(i="function"==typeof(i=t[e.attributes["dill-template"].nodeValue])?i.apply(t):i)&&(e.innerHTML=i),t._template=n)},function(){var a=[],r=window._dill;window.dill=new function(){this.modules={},this.module=function(e,t){return this.modules[e]=r.create_module(e,void 0===t?[]:t),this.modules[e]},this.render=function(e,t,n){var i;void 0===n&&(n=this.module()),i=r.create_template(e,t,n),r.render_element(e,i),a.push({target:e,template:i})},this.change=function(e){e&&e(),a.forEach(function(e){r.render_element(e.target,e.template)}.bind(this))},this.component=window._dill.generate_component,this.service=window._dill.generate_service,this.bubble_change=function(e,t,n){var i=function(e,t,n){if(!e.hasOwnProperty(t))return e.hasOwnProperty("_display")?i(e._display,t,n):void 0;e[t]=n};i(e,t,n)}},delete window._dill}();