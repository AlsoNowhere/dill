"use strict";window._dill={modules:{}},function(){var r=function(t,e){var n,i,a=!1;return"!"===t.charAt(0)&&(t=t.substring(1,t.length),a=!0),n="function"==typeof(i=e[t])?i.apply(e):i,a&&(n=!n),void 0===n?"":n};window._dill.debracer=r,window._dill.bracer=function(t,i){var a=function(t){var e=t.indexOf("{{"),n=t.indexOf("}}");return-1===e?t:-1===n?t:t.substring(0,e)+r(t.substring(e+2,n),i)+a(t.substring(n+2,t.length))};return a(t)}}(),function(){var r=function(t,e,n,i,a){this.name=t,this.data=e,this.template=n,this.type=i||"global",this.module=a};window._dill.Component=r,window._dill.generate_component=function(t,e,n,i,a){return new r(t,e,n,i,a)}}(),function(){var l=function(t,e,n){this.type=t,this.data=e,this.module=n,this.data._module=n};window._dill.create_template=function(t,e,n){var i,a=new l(t.nodeName,e,n),r=a.data;return"#text"===t.nodeName||"#comment"===t.nodeName?(a.value=t.nodeValue,a):(this.dill_extends&&this.dill_extends(t,e),i=t.hasAttribute("dill-for"),this.template_for&&this.template_for(t,a),i||(this.template_if&&this.template_if(t,a),this.dill_template&&this.dill_template(t,a),this.template_component&&function(){this.template_component(t,a,n)}.apply(this),a.attributes=this.create_attributes(t,a,n,r),a.component&&a.data.hasOwnProperty("oninit")&&a.data.oninit(),a.childs=Array.prototype.map.apply(t.childNodes,[function(t){return this.create_template(t,a.data,n)}.bind(this)])),a)}}(),window._dill.create_data_object=function(t){var e=t.template_object,n=t.parent_data,i=t.index,a=t.scope,r=function(e){"object"==typeof e&&Object.keys(e).forEach(function(t){Object.defineProperty(this,t,{value:e[t],writable:!0})}.bind(this)),void 0!==i&&(this._item=e,this._index=i),"normal"===a&&(this._display=n)};return"normal"===(a=void 0===a||"isolate"!==a?"normal":a)&&(r.prototype=n),new r(e)},window._dill.dill_extends=function(t,e){t.hasAttribute("dill-extends")&&(function(n,i,a){if(void 0===a)throw"No value for property 'dill-extends' on dill-extends=\""+n.attributes["dill-extends"].nodeValue+'"';Object.keys(a).forEach(function(t){var e="["===t.charAt(0)&&"]"===t.charAt(t.length-1)?":"+t.substring(1,t.length-1):"("===t.charAt(0)&&")"===t.charAt(t.length-1)?t.substring(1,t.length-1)+":":t;"oninit"!==t?n.setAttribute(e,a[t]):a[t].apply(i)})}(t,e,e[t.attributes["dill-extends"].nodeValue]),t.removeAttribute("dill-extends"))},window._dill.template_for=function(t,e){if(t.hasAttribute("dill-for")&&e.data[t.attributes["dill-for"].nodeValue]){var n,i=e.data[t.attributes["dill-for"].nodeValue].length,a=t.attributes["dill-for"].nodeValue;n=this.create_data_object({template_object:e.data[t.attributes["dill-for"].nodeValue][0],parent_data:e.data,index:0}),e.data=n,t.removeAttribute("dill-for"),e.for={clone:t.cloneNode(!0),initial:1,currents:0<i?[this.create_template(t,n,e.module)]:[],value:a}}},window._dill.render_for=function(t,e){var n,i,a,r=t,l=e.data[e.for.value];if(1===e.for.initial&&0===e.for.currents.length&&e.for.currents.push(this.create_template(r,e.data,e.module)),e.for.initial<l.length){for(n=1;n<e.for.initial;n++)r=r.nextElementSibling;for(n=e.for.initial;n<l.length;n++)r=0===e.for.initial&&n===e.for.initial?(r.parentNode.insertBefore(e.for.clone.cloneNode(!0),t),t.previousElementSibling):(r.insertAdjacentElement("afterend",e.for.clone.cloneNode(!0)),r.nextElementSibling),i=this.create_data_object({template_object:l[n],parent_data:e.data._display,index:n}),e.data=i,r.removeAttribute("dill-for"),a=this.create_template(r,e.data,e.module),e.for.currents.push(a)}else if(e.for.initial>l.length){for(n=1;n<l.length;n++)r=r.nextElementSibling;for(n=0;n<e.for.initial-l.length;n++)r.parentNode.removeChild(n===e.for.initial-l.length-1?r:r.nextElementSibling),e.for.currents.pop()}if(r=t,0===e.for.initial)for(n=0;n<l.length;n++)r=r.previousElementSibling;for(e.for.initial=l.length,n=0;n<e.for.initial;n++)e.for.currents[n].data._item=l[n],e.for.currents[n].data._index=n,"object"==typeof l[n]&&Object.keys(l[n]).forEach(function(t){e.for.currents[n].data[t]=l[n][t]}),this.render_element(r,e.for.currents[n]),r=r.nextElementSibling;return e.for.initial},window._dill.template_if=function(t,e){t.hasAttribute("dill-if")&&(e.if={element:t,value:t.attributes["dill-if"].nodeValue,initial:!0,parent:t.parentNode})},window._dill.render_if=function(t,e){var n=this.debracer(e.if.value,e.data);if(!e.if.initial&&n)void 0===t?e.if.parent.appendChild(e.if.element):t.parentNode.insertBefore(e.if.element,t),t=e.if.element,e.if.initial=n;else{if(e.if.initial&&!n)return t.parentNode.removeChild(t),e.if.initial=n,0;if(!e.if.initial&&!n)return 0}return t},window._dill.for_each=function(t,e){for(var n=t.length-1;0<=n;n--)e(t[n],n)},function(){window._dill;var i=function(t,n,e){this.name=t,this.components={},this.services={},this.elements={},e&&e.forEach(function(e){if("string"==typeof e)e=n.modules[e];else if(!(e instanceof i))return;Object.keys(e.elements),Object.keys(e.components).forEach(function(t){"global"===e.components[t].type&&(this.components[t]=e.components[t])}.bind(this)),Object.keys(e.services).forEach(function(t){this.services[t]=e.services[t]}.bind(this))}.bind(this))};i.prototype={set_component:function(t,e){this.components[t.name]=t},set_service:function(t){this.services[t.name]=t.data},set_element:function(t,e){this.elements[t]=e}},window._dill.Module=i;var a,r=(a=window._dill.Module,function(t,e,n){var i=new a(t,e,n);return Object.seal(i),Object.freeze(i),i});window._dill.create_module=function(t,e,n){return r(t,e,n)}}(),window._dill.render_attributes=function(n,i){i.attributes&&i.attributes.forEach(function(t){var e="function"==typeof i.data[t.value]?i.data[t.value]():i.data[t.value];i.component||("value"!==t.name?n.setAttribute(t.name,"literal"===t.type?t.value:"bind"===t.type?e:"default"===t.type?this.bracer(t.value,i.data):null):n.value=e)}.bind(this))},window._dill.render_element=function(i,e){var t;if("#text"===e.type)return i.nodeValue=this.bracer(e.value,e.data),1;if("#comment"===e.type)return 1;if(e.hasOwnProperty("for"))return this.render_for(i,e);if(e.hasOwnProperty("if")){if(0===(t=this.render_if(i,e)))return t;i=t}return e.template&&function(){var t=e.template;i.innerHTML="function"==typeof t?t.apply(e.data):t,e=this.create_template(i,e.data,e.module),this.render_element(i,e),e.template=t}.apply(this),this.render_attributes(i,e),function(){var n=0;e.childs&&e.childs.forEach(function(t,e){n+=this.render_element(i.childNodes[n],t)}.bind(this))}.apply(this),1},function(){var n=function(t,e){this.name=t,this.data="function"==typeof e?new e:"object"!=typeof e||Array.isArray(e)?null:e};window._dill.Service=n,window._dill.generate_service=function(t,e){return new n(t,e)}}(),window._dill.create_attributes=function(c,f,h,p){var m=[];return this.for_each(c.attributes,function(t){var e,n=t.nodeName,a=t.nodeValue,i=n.charAt(0),r=n.charAt(n.length-1),l=n.substr(0,2),o=n.substr(n.length-2,2),d="'"===a.charAt(0)&&"'"===a.charAt(a.length-1,1),s=function(){c.removeAttribute(n)},u=function(t,e,n){var i={};e&&(i.get=function(){return p[a]}),n&&(i.set=function(t){dill.bubble_change(p,a,t)}),Object.defineProperty(f.data,t,i)};return"#"===n.charAt(0)?(h.set_element(n.substring(1,n.length),c),s()):("[(value)]"!==n&&":value:"!==n||(c.addEventListener("input",function(){f.data[a]=c.value,dill.change()}.bind(this)),c.setAttribute(":value",a),s()),"[("===l&&")]"===o||":"===i&&":"===r?(f.component&&u(n.substring(2,n.length-2),!0,!0),s()):"["===i&&"]"===r||":"===i?(f.component?u(n.substring(1,n.length-1),!0,!1):m.push({name:n.substring(1,n.length-(":"!==i)),value:d?a.substring(1,a.length-1):a,type:d?"literal":"bind"}),s()):"("===i&&")"===r||":"===r?(f.component?u(n.substring(1,n.length-1),!1,!0):(e=n.substring(":"===r?0:1,n.length-1),c.addEventListener(e,function(t){void 0!==f.data[a]?!1!==f.data[a].apply(f.data,[t,c])&&dill.change():dill.change()})),s()):void("dill-"!==n.substr(0,5)&&(f.component?f.data[n]=p[a]:m.push({name:n,value:d?a.substring(1,a.length-1):a,type:d?"literal":"default"}))))}.bind(this)),m},window._dill.template_component=function(t,e,n){var i=n.components[t.nodeName.toLowerCase()];if(i)return e.component=!0,"function"==typeof i.data&&(i.data=new i.data),e.data=this.create_data_object({template_object:i.data,parent_data:e.data,scope:t.hasAttribute("dill-scope")?t.attributes["dill-scope"].nodeValue:void 0}),e.data._template=t.innerHTML,t.innerHTML=i.template,console.log("Component 2: ",e),i.hasOwnProperty("module")?i.module:void 0},window._dill.dill_template=function(t,e){var n;t.hasAttribute("dill-template")&&(n=e.data[t.attributes["dill-template"].nodeValue],e.template=n,t.removeAttribute("dill-template"))},function(){var o=[],d=window._dill;window.dill=new function(){this.modules={},this.module=function(t,e){return this.modules[t]||(this.modules[t]=d.create_module(t,this,void 0===e?[]:e)),this.modules[t]},this.render=function(t,e,n){var i,a,r,l;a=t,r=e,l=n,i=d.create_template(a,r,l),d.render_element(a,i),o.push({target:a,template:i})},this.change=function(t){t&&t(),o.forEach(function(t){d.render_element(t.target,t.template)}.bind(this))},this.component=window._dill.generate_component,this.service=window._dill.generate_service,this.bubble_change=function(t,e,n){var i=function(t,e,n){if(!t.hasOwnProperty(e))return t.hasOwnProperty("_display")?i(t._display,e,n):void 0;t[e]=n};i(t,e,n)}},delete window._dill}();