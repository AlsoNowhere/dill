"use strict";window._dill={},window._dill.bracer=function(e,a){var l=function(e){var t,n,i,o=e.indexOf("{{"),r=e.indexOf("}}");return-1===o?e:-1===r?e:e.substring(0,o)+(t=e.substring(o+2,r),void 0===(i="function"==typeof(n=a)[t]?n[t]():n[t])?"":i)+l(e.substring(r+2,e.length))};return l(e)},function(){var i=function(e,t,n){this.name=e,this.data=t,this.template=n};window._dill.generate_component=function(e,t,n){this.components[e]=new i(e,t,n)}}(),window._dill.compose_components=function(e,t,n){return"#text"===e.nodeName||"#comment"===e.nodeName||(e.hasAttribute("dill-for")&&!n&&(t=t[e.attributes["dill-for"].nodeValue]?this.create_data_object(t[e.attributes["dill-for"].nodeValue][0],t,0):t),dill.components[e.nodeName.toLowerCase()]&&(e.innerHTML=dill.components[e.nodeName.toLowerCase()].template,t=this.create_data_object(dill.components[e.nodeName.toLowerCase()].data,t)),this.create_events(e,t),this.for_each(e.childNodes,function(e){this.compose_components(e,t)}.bind(this))),e},window._dill.create_attributes=function(e,t){var n=[];return this.for_each(e.attributes,function(e){var t=e.nodeName;"["===t.substr(0,1)&&"]"===t.substr(t.length-1,1)&&n.push({name:t.substring(1,t.length-1),value:e.nodeValue})}.bind(this)),this.create_events(e,t),n},window._dill.create_events=function(i,o){this.for_each(i.attributes,function(t){var e,n=t.nodeName;"("===n.substr(0,1)&&")"===n.substr(n.length-1,1)&&(e=n.substring(1,n.length-1),i.addEventListener(e,function(e){void 0===o[t.nodeValue]?dill.change():!1!==o[t.nodeValue].apply(o,[e])&&dill.change()}))}.bind(this))},window._dill.create_template=function(t,n){var e={type:t.nodeName,value:t.nodeValue};return"#text"===t.nodeName||"#comment"===t.nodeName||(t.hasAttribute("dill-if")&&(e.if=this.generate_template(t,"if")),t.hasAttribute("dill-for")&&(e.for=this.generate_template(t,"for"),n[e.for.value]&&(n=this.create_data_object(n[e.for.value][0],n,0))),dill.components[t.nodeName.toLowerCase()]&&(t.innerHTML=dill.components[t.nodeName.toLowerCase()].template,n=this.create_data_object(dill.components[t.nodeName.toLowerCase()].data,n)),e.attributes=this.create_attributes(t,n),t.hasAttribute("dill-for")&&(e.for.currents=[function(){var e=t.cloneNode(!0);return e.removeAttribute("dill-for"),this.create_template(e,n)}.apply(this)]),e.childs=Array.prototype.map.apply(t.childNodes,[function(e){return this.create_template(e,n)}.bind(this)])),e},window._dill.create_data_object=function(e,n,i){var t=function(t){Object.keys(t).forEach(function(e){this[e]=t[e]}.bind(this)),void 0!==i&&(this._item=t,this._index=i),this._display=n};return t.prototype=n,new t(e)},window._dill.render_for=function(e,t,n,i){var o=e;if(!t[n.for.value])return e.parentNode.removeChild(e),n.for.currents=[],0;if(n.for.initial<t[n.for.value].length){for(var r=1;r<n.for.initial;r++)o=o.nextElementSibling;var a=0,l=t[n.for.value].length;for(r=n.for.initial;r<l;r++){var s=this.compose_components(n.for.clone.cloneNode(!0),this.create_data_object(t[n.for.value][l-1-a],t,l-1-a),!0);a++,0<n.for.initial?o.insertAdjacentElement("afterend",s):i.insertBefore(s,e),0<n.for.initial?o.nextElementSibling:o.previousElementSibling,n.for.currents.push(function(){var e=n.for.clone.cloneNode(!0);return e.removeAttribute("dill-for"),this.create_template(e,t)}.apply(this))}}else if(n.for.initial>t[n.for.value].length){for(r=1;r<t[n.for.value].length;r++)o=o.nextElementSibling;for(r=0;r<n.for.initial-t[n.for.value].length;r++)o.parentNode.removeChild(1===n.for.initial?o:o.nextElementSibling),n.for.currents.pop()}for(o=0<n.for.initial?e:e.previousElementSibling,n.for.initial=t[n.for.value].length,r=0;r<n.for.initial;r++)this.render_element({ele:o,data:this.create_data_object(t[n.for.value][r],t,r),template:n.for.currents[r]}),o=o.nextElementSibling;return n.for.initial},window._dill.render_if=function(e,t,n){var i="function"==typeof t[n.if.value]?t[n.if.value]():t[n.if.value];return n.if.initial&&!i?(e.parentNode.removeChild(e),n.if.initial=i,0):n.if.initial||i?(!n.if.initial&&i&&(e.parentNode.insertBefore(n.if.clone,e),e=e.previousSibling,n.if.initial=i),e):0},window._dill.for_each=function(e,t){for(var n=0,i=e.length;n<i;n++)t(e[n],n)},window._dill.generate_template=function(e,t){return new function(){this.value=e.attributes["dill-"+t].nodeValue,this.clone=e.cloneNode(!0),this.initial="for"!==t||1}},window._dill.map_component_attributes=function(e,n){this.for_each(e.attributes,function(e){var t=e.nodeValue;"'"!==t.substr(0,1)||"'"!==t.substr(t.length-1,1)?n[e.nodeName]="true"!==t&&"false"!==t?n[this.bracer(t,n._display)]:"true"===t:n[e.nodeName]=t.substring(1,t.length-1)}.bind(this))},window._dill.render_element=function(e){var t,i=e.ele,o=e.template,r=e.data,n=e.parent;if("#text"===o.type)return i.nodeValue=this.bracer(o.value,r),1;if("#comment"===o.type)return 1;if(o.hasOwnProperty("if")){if(0===(t=this.render_if(i,r,o)))return t;i=t}return o.hasOwnProperty("for")?this.render_for(i,r,o,n):(i.hasAttribute("dill-template")&&(r._template=i.innerHTML,i.innerHTML="function"==typeof r[i.attributes["dill-template"].nodeValue]?r[i.attributes["dill-template"].nodeValue]():r[i.attributes["dill-template"].nodeValue],o=this.create_template(i,r)),dill.components[i.nodeName.toLowerCase()]&&(r=this.create_data_object(dill.components[i.nodeName.toLowerCase()].data,r),this.map_component_attributes(i,r),r.hasOwnProperty("oninit")&&"function"==typeof r.oninit&&r.oninit()),o.attributes.forEach(function(e){var t="function"==typeof r[e.value]?r[e.value]():r[e.value];i.setAttribute(e.name,void 0===t?"":t),"value"===e.name&&setTimeout(function(){void 0!==t&&(i.value=t)},0),t||i.removeAttribute(e.name)}),this.for_each(i.attributes,function(e){"#"===e.nodeName.substr(0,1)&&(this.elements[e.nodeName.substring(1,e.nodeName.length)]=i)}.bind(this)),function(){var n=0;o.childs.forEach(function(e,t){n+=this.render_element({ele:i.childNodes[n],data:r,template:e,parent:i})}.bind(this))}.apply(this),1)},window._dill.generate_service=function(e,t){dill.services[e]="function"==typeof t?new t:t},function(){var i=[],t=window._dill;window._dill.components={},window._dill.services={},window._dill.elements={};var e=function(){this.render=function(e,t){var n=this.create_template(e,t);i.push({ele:e,data:t,template:n}),this.render_element({ele:e,template:n,data:t})},this.change=function(e){e&&e(),t.elements={},i.forEach(function(e){this.render_element({ele:e.ele,template:e.template,data:e.data})}.bind(this))},this.component=window._dill.generate_component,this.service=window._dill.generate_service,this.bubble_change=function(e,t,n){var i=function(e,t,n){if(!e.hasOwnProperty(t))return e.hasOwnProperty("_display")?i(e._display,t,n):void 0;e[t]=n};i(e,t,n)}};e.prototype=window._dill,window.dill=new e,delete window._dill}();