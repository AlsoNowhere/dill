!function(){"use strict";var t=function(t){this.components[t.prototype.name]=t},e=function(t){return Object.seal(t),Object.freeze&&Object.freeze(t),t},n=function(t,e){for(var n,i=0;i<t.length&&!1!==(n=e(t[i],i));)"number"==typeof n&&(i+=n),i++},i=function(t,e){for(var n,i=t.length-1;i>=0&&!1!==(n=e(t[i],i));)"number"==typeof n&&(i-=n),i--},r=function(){var i=function(t,r){var o=this;void 0===r&&(r=[]),r=r.filter(function(t){return t instanceof i}),this.name=t,this.components={},this.services={},n(r,function(t){t instanceof i&&Object.keys(t.components).forEach(function(e){var n=t.components[e];n.isIsolated||(o.components[e]=n)})}),e(this)};return i.prototype={setComponent:t},i}(),o=function(t,e){this.targetElement=t,this.dillTemplate=e},a=[],u=function(t,e){var i=t.split("{{");return n(i,function(t,n){var r=t.indexOf("}}");i[n]=-1===r?t:function(t,e){var n=e[t];return void 0===n&&(n=""),"'"===t.substr(0,1)&&"'"===t.substr(t.length-1,1)?t.substring(1,t.length-1):"function"==typeof n?n.apply(e):n}(t.substring(0,r),e)+t.substring(r+2,t.length)}),i.join("")},s=["value","checked"],f=function(t,e){t.component&&t.data.hasOwnProperty(e)&&"function"==typeof t.data[e]&&t.data[e](),t.children&&n(t.children,function(t){f(t,e)})},l=function(t,e,n){var i=function(){for(var i in t)(function(){var e=t[i];Object.defineProperty(this,i,{get:function(){return e},set:function(t){e=t}})}).apply(this);null===e||n||(this._parent=e)};return null===e||n||(i.prototype=e),new i},d=function(t,e,n){return void 0===n&&(n=e),t.substr(0,e.length)===e&&t.substr(t.length-n.length,t.length)===n};const c=function(t){const e=t.prototype;this.name=e.name,this.template=e.template,e.module&&(this._module=e.module),t.prototype={},this.baseData=new t};var p=function(t,i,r,o){if(this.name=t.nodeName,this.module=r,o&&(this.templateParent=o),"#text"===this.name)return this.value=t.nodeValue,this.data=i,e(this);this.children=[];var a=r.components[this.name.toLowerCase()];if(a&&(a=new c(a)),void 0!==a)return this.component=a,t.hasAttribute("dill-for")?void(this.data=i):(this.data=l(a.baseData,i,!!t.hasAttribute("dill-isolate")),t.removeAttribute("dill-isolate"),void n(t.attributes,function(t){var e,n=t.nodeName,r=t.nodeValue;d(n,"[","]")?(e=n.substring(1,n.length-1),Object.defineProperty(this.data,e,{get:function(){return i[r]},set:function(t){i[r]=t}})):this.data[n]=d(r,"'")?r.substring(1,r.length-1):data[r]}.bind(this)));this.attributes=[],this.data=i},h=function(t){return":"===t.substr(0,1)},m=function(t){return":"===t.substr(t.length-1,1)},v=function(t,n,i){this.name=i.nodeName;var r,o=i.nodeValue;if("#"===this.name.substr(0,1))return n.data[this.name.substring(1)]=t,void(this.type="hashReference");if(r=h(this.name)?this.name.substring(1,this.name.length):m(this.name)?this.name.substring(0,this.name.length-1):this.name.substring(1,this.name.length-1),this.type=function(t){var e=t.nodeName;return d(e,"[","]")||h(e)?"bind":d(e,"(",")")||m(e)?"event":"default"}(i),this.value="literal"===this.type?o.substring(1,o.length-1):o,"default"!==this.type&&(this.parsed=r),o=this.value,"event"!==this.type)e(this);else{var a=n.data[o];t.addEventListener(this.parsed,function(t){void 0!==a&&(!1!==a.apply(n.data,[t,this])&&dill.change())})}},b=function(t,e){var n=t.attributes["dill-template"].nodeValue,i=e.data[n];t.innerHTML="function"==typeof i?i.apply(e.data):i,t.removeAttribute("dill-template")},g=function(t,e){var n=e.data[t.attributes["dill-extends"].nodeValue];t.removeAttribute("dill-extends"),"object"==typeof n&&Object.keys(n).forEach(function(e){var i=e;d(e,"[","]")&&(i=":"+e.substring(1,e.length-1)),d(e,"(",")")&&(i=e.substring(1,e.length-1)+":"),t.setAttribute(i,n[e])})},y=function(t,e){var n=t.attributes["dill-if"].nodeValue,i="!"===n.substr(0,1);i&&(n=n.substring(1,n.length));var r="function"==typeof e.data[n]?e.data[n]():e.data[n];return i&&(r=!r),e.if={parent:t.parentNode,first:r,initial:!0,value:n,invert:i,target:t},t.removeAttribute("dill-if"),r},w=function(t,e){var n=t.attributes["dill-for"].nodeValue;e.for={parent:t.parentNode,initial:[null],templates:[null],value:n,first:!0},t.removeAttribute("dill-for"),e.for.clone=t.cloneNode(!0)},E=function(t,e,r,o){var a,u=new p(t,e,r,o),s=u.data;return"SCRIPT"===u.name?u:(t.attributes&&t.attributes["dill-extends"]&&g&&g(t,u),t.attributes&&t.attributes["dill-if"]&&y&&y(t,u),t.attributes&&i(t.attributes,function(e){if(u.if||"dill-template"!==e.nodeName)return!u.if&&"dill-for"===e.nodeName&&w?w(t,u):void(!u.component&&u.attributes.push(new v(t,u,e)))}),u.attributes&&i(u.attributes,function(e,n){"event"!==e.type&&"hashReference"!==e.type||u.attributes.splice(n,1),"default"!==e.type&&t.removeAttribute(e.name)}),u.if&&!1===u.if.first?u:(t.attributes&&t.attributes["dill-template"]&&b&&b(t,u),u.component&&((u.for?u.for.first:u.for)||(s._template=t.innerHTML,t.innerHTML=u.component.template,a=t.getElementsByTagName(u.component.name.toUpperCase()),n(a,function(e){for(var n=!1,i=e;i!==t&&!n;)n=i.hasAttribute("dill-if"),i=i.parentNode}))),(u.for?u.for.first:u.for)||t.childNodes&&n(t.childNodes,function(t){u.children.push(E(t,s,r,u))}),u.for&&(u.for.first=!1),u.component&&s.hasOwnProperty("oninit")&&s.oninit(),u))},N=function(t,e){var i,r=e.data,o=e.if.invert,a=e.if.value,u="function"==typeof r[a]?r[a]():r[a],s=e.if.initial,l=o?!u:!!u,d=e.if.parent;return!1===s&&!1===l?0:!1===s&&!0===l?(void 0===t?d.appendChild(e.if.target):d.insertBefore(e.if.target,t),!1===e.if.first?(e.if.first=!0,e.if.target.attributes&&e.if.target.attributes["dill-template"]&&b(e.if.target,e),e.component&&(e.data._template=e.if.target.innerHTML,e.if.target.innerHTML=e.component.template,i=e.if.target.getElementsByTagName(e.component.name.toUpperCase()),n(i,function(t){for(var n=!1,i=t;i!==e.if.target&&!n;)n=i.hasAttribute("dill-if"),i=i.parentNode;if(!n)throw new Error("Recursive element detected without conditional catch. To avoid infinite loop render was stopped.")}),e.data.hasOwnProperty("oninit")&&e.data.oninit()),e.if.target.childNodes&&n(e.if.target.childNodes,function(t){e.children.push(E(t,e.data,e.data._module,e))})):f(e,"oninit"),e.if.initial=!0,"added"):!0===s&&!1===l?(d.removeChild(e.if.target),f(e,"onremove"),e.if.initial=!1,0):void 0},O=function(t,e){var n;for(n in t)e.hasOwnProperty(n)?e[n]=t[n]:function(){var i;Object.defineProperty(e,n,{get:function(){return i},set:function(t){i=t}}),e[n]=t[n]}();for(n in e)"_"!==n.substr(0,1)&&(t.hasOwnProperty(n)||delete e[n])};const x=function(t){if(void 0!==t){var e=[{name:"noIf",type:"bool"},{name:"noFor",type:"bool"},{name:"parent",type:"object"}];Object.keys(t).forEach(function(n){var i=e.filter(function(t){return t.name===n}),r=t[n];1===i.length&&t[n]&&(this[n]="bool"===i[0].type?!!r:r)}.bind(this))}};var j=function(t,e,i,r){var o,a,d,p,h,m,v=e.name,b="boolean"==typeof i&&i,g=function(){i=!0,b=!0};if(r instanceof x||(r=new x),"boolean"!=typeof i&&(i instanceof Element&&i===t?g():!(i instanceof Element)&&i instanceof Object&&e.component instanceof c&&e.component.baseData instanceof i&&g()),"#comment"===v||"SCRIPT"===v)return 1;if("#text"===v)return!0===b&&function(t,e){var n=t.nodeValue,i=u(e.value,e.data);n!==i&&(t.nodeValue=i)}(t,e),1;if(!0===b){if(!r.noIf&&e.hasOwnProperty("if")){if("added"===(o=N(t,e)))return h=r&&r.parent&&r.parent.childNodes,j(void 0===t?h[h.length-1]:t.previousElementSibling,e,i,new x({noIf:!0})),1;if(0===o)return o}if(!r.noFor&&e.hasOwnProperty("for")&&"number"==typeof(a=function(t,e,n){var i=e.for.initial.length,r="function"==typeof e.data[e.for.value]?e.data[e.for.value]():e.data[e.for.value],o=e.for.initial,a=r.length,u=t,s=e.for.parent,d=e.for.templates,c=function(){return e.for.clone.cloneNode(!0)};return i!==a&&(i>a&&function(){for(var t,n=0;n<a;)u=u.nextElementSibling,n++;for(;n<i;)t=u.nextElementSibling,s.removeChild(u),f(e,"onremove"),u=t,n++}(),i<a&&function(){for(var t,o=0;o<i-1;)u=u.nextElementSibling,o++;if(0===i){void 0===u?(u=c(),s.appendChild(u)):(s.insertBefore(c(),u),u=u.previousElementSibling);var f=l(r[0],e.data);f._item=r[0],f._index=0,t=E(u,f,e.module,e),d[0]=t,j(u,t,n)}for(;o<a-1;)u.insertAdjacentElement("afterend",c()),u=u.nextElementSibling,function(){var t=o+1,i=l(r[t],e.data);i._item=r[t],i._index=t;var a=E(u,i,e.module,e);d[t]=a,j(u,a,n)}(),o++}()),function(){var p,h=0;for(u=t;h<(i<a?i:a);)r[h]!==o[h]?(p=u.nextSibling,s.removeChild(u),f(e,"onremove"),null===p?(s.appendChild(c()),u=s.children[s.children.length-1]):(s.insertBefore(c(),p),u=p.previousElementSibling),function(){var t=l(r[h],e.data);t._item=r[h],t._index=h;var i=E(u,t,e.module,e);d[h]=i,j(u,i,n)}(),u=u.nextElementSibling,h++):("object"==typeof r[h]&&O(r[h],d[h].data),j(u,d[h],n),u=u.nextElementSibling,h++)}(),e.for.initial=r.map(function(t){return t}),a}(t,e,i)))return a;d=t,(p=e).attributes&&n(p.attributes,function(t){var e,n=t.type,i=t.parsed||t.name,r=u(t.value,p.data),o=!!d.attributes[i];if("bind"===n){if(e="function"==typeof p.data[r]?p.data[r].apply(p.data):p.data[r],s.indexOf(i)>-1){if(d[i]===("number"==typeof e?e.toString():e))return;return void("SELECT"===d.nodeName?setTimeout(function(){d[i]=e},0):d[i]=e)}if(o){if(d.attributes[i].nodeValue===e)return;return void 0===e||!1===e?d.removeAttribute(i):void(d.attributes[i].nodeValue=e)}if(void 0===e||!1===e)return;d.setAttribute(i,e)}else if("default"===n){if(o){if(d.attributes[i].nodeValue===r)return;return void(d.attributes[i].nodeValue=r)}d.setAttribute(i,r)}})}return m=0,n(e.children,function(e,n){if(void 0!==t){var r=t.childNodes[m],o=j(r,e,i,void 0===r?new x({parent:t}):void 0);m+=o}}),1},A=function(t){n(a,function(e){e instanceof o&&j(e.targetElement,e.dillTemplate,t||!0)})};var C={render:function(t,e,n){var i=l(new e,null);i._module=n;var r=E(t,i,n);return i.oninit&&i.oninit(),a.push(new o(t,r)),A(),i},change:A,module:function(t,e){return new r(t,e)},ComponentPrototype:function(t,e,n){this.name=t,this.template=e},reset:function(){a.length=0}};window.dill=C}();